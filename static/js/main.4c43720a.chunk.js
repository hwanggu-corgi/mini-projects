(this["webpackJsonpchat-application"]=this["webpackJsonpchat-application"]||[]).push([[0],{117:function(n,e,t){"use strict";t.r(e);var a,r,c,o,i=t(31),s=t(2),l=t.n(s),d=t(76),u=t.n(d),b=(t(94),t(95),t(33)),j=t(13),m=t(88),p=t(6),O=t(7),h=t(14),g=t(20),x=t(49),f=t(50),v=t(3),y="#EEEEEE",w=O.a.div(a||(a=Object(p.a)(["\n    background-color: ",";\n    padding: 1em;\n    border-radius: 5em;\n    display:flex;\n    flex-grow: 1;\n"])),y),F=O.a.textarea(r||(r=Object(p.a)(["\n    border: none;\n    resize: none;\n    width: 100%;\n    background-color: ",";\n    text-decoration: none;\n    padding: 1em;\n    overflow-y: scroll;\n\n    &:focus {\n        outline: none;\n    }\n"])),y);function k(n){return Object(v.jsx)(w,{children:Object(v.jsx)(F,{value:n.value,onChange:n.onChange})})}var S=O.a.button(c||(c=Object(p.a)(["\n    border: none;\n    background-color: white;\n    font-size: 1.5em;\n    text-decoration: none;\n    color: ",";\n    padding: 0.5em;\n    margin: 0.5em;\n    cursor: pointer;\n\n    &:disabled {\n        opacity: 0.8;\n    }\n"])),"#FFA341");function C(n){return Object(v.jsx)(S,{onClick:n.onClick,disabled:n.disabled,children:Object(v.jsx)(x.a,{icon:f.a})})}var E=Object(h.gql)(o||(o=Object(p.a)(["\n    mutation PostMutation(\n        $texts: String!\n    ) {\n        post(texts: $texts) {\n            id\n            postedBy {\n            id,\n                username\n            }\n            texts\n        }\n    }\n"])));function A(n){var e=Object(s.useState)(""),t=Object(g.a)(e,2),a=t[0],r=t[1],c=Object(h.useMutation)(E,{variables:{texts:a},onCompleted:function(n){r("")},onError:function(n){alert("Error occured")}}),o=Object(g.a)(c,1)[0];return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(k,{value:a,onChange:function(n){return r(n.target.value)}}),Object(v.jsx)(C,{onClick:o,disabled:!function(n){return!(!n||""===n.trim())}(a)})]})}var T,B,M,I,z=t(82),U=t(83),$=t(89),q=t(87);function D(n){var e=n.texts.split("\n").map((function(n){return Object(v.jsx)("p",{children:n})})),t=localStorage.getItem("USERNAME"),a=O.a.div(T||(T=Object(p.a)(["\n        display: flex;\n        justify-content: ",";\n    "])),n.postedBy.username===t?"flex-end":"initial"),r=O.a.section(B||(B=Object(p.a)(["\n        margin: 0;\n        background-color: ",";\n        padding: 1em;\n        border-radius: 1.5em;\n        max-width: 12em;\n        font-size: 0.8em;\n        white-space: pre-wrap;\n    "])),"#FFA341"),c=O.a.header(M||(M=Object(p.a)(["\n        font-size: 0.7em;\n        padding: 0.5em 1em;\n    "])));return Object(v.jsx)(a,{children:Object(v.jsxs)("article",{children:[Object(v.jsx)(c,{children:Object(v.jsx)("span",{children:n.postedBy.username})}),Object(v.jsx)(r,{children:e})]})})}function N(n){return n.chats.map((function(n){return Object(v.jsx)(D,Object(i.a)({},n),n.id)}))}var R,P,L,H,K,_,J,Q,V=function(n){Object($.a)(t,n);var e=Object(q.a)(t);function t(n){var a;return Object(z.a)(this,t),(a=e.call(this,n)).scrollToBottom=function(){a.scrollToBottomRef.current.scrollIntoView({behavior:"auto"})},a.scrollToBottomRef=l.a.createRef(),a}return Object(U.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var n=O.a.section(I||(I=Object(p.a)(["\n            flex-grow: 1;\n            overflow-y: scroll;\n            padding: 1em;\n        "])));return Object(v.jsxs)(n,{ref:this.sectionRef,children:[Object(v.jsx)(N,{chats:this.props.chats}),Object(v.jsx)("div",{ref:this.scrollToBottomRef})]})}}]),t}(s.Component),G="#FFA341";function W(){var n=Object(j.f)(),e=O.a.button(R||(R=Object(p.a)(["\n        border: none;\n        background-color: ",";\n        font-size: 0.8em;\n        text-decoration: none;\n        color: ",";\n        padding: 0.5em 1em;\n        margin: 0.5em;\n        cursor: pointer;\n        border-radius: 5em;\n\n        &:disabled {\n            opacity: 0.8;\n        }\n    "])),"#FFFFFF",G);return Object(v.jsx)(e,{onClick:function(){localStorage.clear(),n.push("/")},children:"Logout"})}function X(){var n=Object(s.useState)(!1),e=Object(g.a)(n,2),t=e[0],a=e[1],r=O.a.button(P||(P=Object(p.a)(["\n        background-color: transparent;\n        border: none;\n        padding: 0.5em;\n        cursor: pointer;\n    "]))),c=O.a.nav(L||(L=Object(p.a)(["\n        padding: 0.39em 0.75em;\n        background-color: ",";\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    "])),G),o=O.a.div(H||(H=Object(p.a)(["\n        background-color: white;\n        width: 1.75em;\n        height: 0.12em;\n        margin-bottom: 0.4em;\n\n        &:last-child {\n            margin: 0;\n        }\n    "])));return Object(v.jsxs)(c,{children:[Object(v.jsxs)(r,{onClick:function(n){return a(!t)},children:[Object(v.jsx)(o,{}),Object(v.jsx)(o,{}),Object(v.jsx)(o,{})]}),Object(v.jsx)(W,{})]})}var Y,Z,nn,en,tn;function an(n){var e=localStorage.getItem("USERNAME"),t=n.users.map((function(n){return Object(v.jsx)(rn,Object(i.a)(Object(i.a)({},n),{},{isOwner:e===n.username}),n.id)})),a=O.a.ul(K||(K=Object(p.a)(["\n        list-style: none;\n        padding: 0;\n        margin: 0;\n        height: calc(100vh - ",");\n        width: 15em;\n        box-shadow: 2px 0px ",";\n    "])),"3.30em","#EEEEEE");return Object(v.jsx)(a,{children:t})}function rn(n){var e=O.a.div(_||(_=Object(p.a)(["\n        color: ",";\n        background-color: ",";\n        padding: 0.8em;\n        display: inline-block;\n        border-radius: 50%;\n        margin-right: 1em;\n\n        div {\n            width: 1.25em;\n            height: 1.25em;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        }\n    "])),"#FFFFFF","#FFA341"),t=O.a.span(J||(J=Object(p.a)(["\n        font-size: 0.8em;\n    "]))),a=O.a.li(Q||(Q=Object(p.a)(["\n        display: flex;\n        align-items: center;\n        padding: 0.5em 1em;\n    "])));return Object(v.jsxs)(a,{children:[Object(v.jsx)(e,{children:Object(v.jsx)("div",{children:Object(v.jsx)(x.a,{icon:f.b})})}),Object(v.jsxs)(t,{children:[n.username," ",n.isOwner?"(Me)":""]})]})}var cn=O.a.div(Y||(Y=Object(p.a)(["\n    display: flex;\n"]))),on=O.a.section(Z||(Z=Object(p.a)(["\n    height: calc(100vh - ",");\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n"])),"3.30em"),sn=O.a.section(nn||(nn=Object(p.a)(["\n    display: flex;\n    padding: 1em;\n"]))),ln=Object(h.gql)(en||(en=Object(p.a)(["\n  query {\n    users {\n      id,\n      username\n    },\n    chats {\n      id,\n      postedBy {\n        username\n      },\n      texts\n    }\n  }\n"]))),dn=Object(h.gql)(tn||(tn=Object(p.a)(["\n  subscription {\n    newChat {\n      id\n      texts\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"])));var un,bn,jn,mn,pn,On,hn,gn,xn=function(){var n=Object(h.useQuery)(ln),e=n.data,t=n.subscribeToMore,a=e&&e.chats?e.chats:[],r=e&&e.users?e.users:[];return t({document:dn,updateQuery:function(n,e){var t=e.subscriptionData;if(!t.data)return n;var a=t.data.newChat;return n.chats.find((function(n){return n.id===a.id}))?n:Object.assign({},n,{chats:[].concat(Object(m.a)(n.chats),[a]),users:n.users})}}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(X,{}),Object(v.jsxs)(cn,{children:[Object(v.jsx)(an,{users:r}),Object(v.jsxs)(on,{children:[Object(v.jsx)(V,{chats:a}),Object(v.jsx)(sn,{children:Object(v.jsx)(A,{})})]})]})]})},fn="#FFFFFF",vn=O.a.section(un||(un=Object(p.a)(["\n  width: 100vw;\n  height: 100vh;\n  background-color: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),"#FFA341"),yn=O.a.div(bn||(bn=Object(p.a)(["\n  color: ",";\n  width: 15em;\n  display: flex;\n  flex-direction: column;\n"])),fn),wn=O.a.h1(jn||(jn=Object(p.a)(["\n  text-align: center;\n"]))),Fn=O.a.form(mn||(mn=Object(p.a)(["\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    display: block;\n  }\n\n  & > * {\n    margin-bottom: 0.5em;\n  }\n\n  & > input:last-of-type {\n    margin-bottom: 1.5em;\n  }\n\n  & > *:last-child {\n    margin: 0;\n  }\n"]))),kn=O.a.input(pn||(pn=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  background-color: white;\n  border-radius: 5em;\n  text-align: center;\n\n  &:placeholder {\n      text-align: center;\n  }\n"]))),Sn=O.a.button(On||(On=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  color: ",";\n  font-size: 0.8em;\n"])),"#9A4D31",fn),Cn=Object(O.a)(b.b)(hn||(hn=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  font-size: 0.8em;\n  text-decoration: none;\n  color: black;\n"])),"#FFE24F"),En=Object(h.gql)(gn||(gn=Object(p.a)(["\n  mutation LoginMutation(\n    $username: String!\n    $password: String!\n  ) {\n    login(\n      username: $username\n      password: $password\n    ) {\n      token\n      user {\n        username\n      }\n    }\n  }\n"])));var An,Tn,Bn,Mn,In,zn,Un,$n,qn=function(){var n=Object(j.f)(),e=Object(s.useState)(""),t=Object(g.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)(""),o=Object(g.a)(c,2),i=o[0],l=o[1],d=Object(h.useMutation)(En,{variables:{username:a,password:i},onCompleted:function(e){var t=e.login;localStorage.setItem("AUTH_TOKEN",t.token),localStorage.setItem("USERNAME",t.user.username),n.push("/chat")}}),u=Object(g.a)(d,1)[0];return Object(v.jsx)(vn,{children:Object(v.jsxs)(yn,{children:[Object(v.jsx)(wn,{children:"Chat Application"}),Object(v.jsxs)(Fn,{children:[Object(v.jsx)(kn,{type:"text",placeholder:"Username",value:a,onChange:function(n){return r(n.target.value)}}),Object(v.jsx)(kn,{type:"password",placeholder:"Password",value:i,onChange:function(n){return l(n.target.value)}}),Object(v.jsx)(Sn,{type:"submit",onClick:function(n){n.preventDefault(),u()},disabled:!function(n,e){return!(!n||!e)&&(""!==n.trim()&&""!==e.trim())}(a,i),children:"Login"}),Object(v.jsx)(Cn,{to:"/signup",children:"Signup"})]})]})})},Dn="#FFFFFF",Nn=O.a.section(An||(An=Object(p.a)(["\n  width: 100vw;\n  height: 100vh;\n  background-color: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),"#FFA341"),Rn=O.a.div(Tn||(Tn=Object(p.a)(["\n  color: ",";\n  width: 15em;\n  display: flex;\n  flex-direction: column;\n"])),Dn),Pn=O.a.h1(Bn||(Bn=Object(p.a)(["\n  text-align: center;\n"]))),Ln=O.a.form(Mn||(Mn=Object(p.a)(["\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    display: block;\n  }\n\n  & > * {\n    margin-bottom: 0.5em;\n  }\n\n  & > input:last-of-type {\n    margin-bottom: 1.5em;\n  }\n\n  & > *:last-child {\n    margin: 0;\n  }\n"]))),Hn=O.a.input(In||(In=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  background-color: white;\n  border-radius: 5em;\n  text-align: center;\n\n  &:placeholder {\n      text-align: center;\n  }\n"]))),Kn=O.a.button(zn||(zn=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  color: ",";\n  font-size: 0.8em;\n\n  &:disabled,\n  &[disabled]{\n    opacity: 0.6;\n  }\n"])),"#9A4D31",Dn),_n=Object(O.a)(b.b)(Un||(Un=Object(p.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  font-size: 0.8em;\n  text-decoration: none;\n  color: black;\n"])),"#FFE24F"),Jn=Object(h.gql)($n||($n=Object(p.a)(["\n  mutation SignupMutation(\n    $username: String!\n    $password: String!\n  ) {\n    signup(\n      username: $username\n      password: $password\n    ) {\n      token\n      user {\n        username\n      }\n    }\n  }\n"])));var Qn=function(n){var e=Object(j.f)(),t=Object(s.useState)(""),a=Object(g.a)(t,2),r=a[0],c=a[1],o=Object(s.useState)(""),i=Object(g.a)(o,2),l=i[0],d=i[1],u=Object(s.useState)(""),b=Object(g.a)(u,2),m=b[0],p=b[1],O=Object(h.useMutation)(Jn,{variables:{username:r,password:l},onCompleted:function(n){var t=n.signup;localStorage.setItem("AUTH_TOKEN",t.token),localStorage.setItem("USERNAME",t.user.username),e.push("/chat")}}),x=Object(g.a)(O,1)[0];return Object(v.jsx)(Nn,{children:Object(v.jsxs)(Rn,{children:[Object(v.jsx)(Pn,{children:"Chat Application"}),Object(v.jsxs)(Ln,{children:[Object(v.jsx)(Hn,{type:"text",placeholder:"Username",value:r,onChange:function(n){return c(n.target.value)}}),Object(v.jsx)(Hn,{type:"password",placeholder:"Password",value:l,onChange:function(n){return d(n.target.value)}}),Object(v.jsx)(Hn,{type:"password",placeholder:"Password Confirm",value:m,onChange:function(n){return p(n.target.value)}}),Object(v.jsx)(Kn,{type:"submit",onClick:function(n){n.preventDefault(),x()},disabled:!function(n,e,t){return!!(n&&e&&t)&&(""!==n.trim()&&(""!==e.trim()&&(""!==t.trim()&&e.value===t.value)))}(r,l,m),children:"Signup"}),Object(v.jsx)(_n,{to:"/",children:"Back"})]})]})})};var Vn=function(){return Object(v.jsx)(b.a,{children:Object(v.jsx)("main",{className:"App",children:Object(v.jsxs)(j.c,{children:[Object(v.jsx)(j.a,{path:"/chat",component:xn}),Object(v.jsx)(j.a,{exact:!0,path:"/signup",component:Qn}),Object(v.jsx)(j.a,{exact:!0,path:"/",component:qn})]})})})},Gn=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,118)).then((function(e){var t=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;t(n),a(n),r(n),c(n),o(n)}))},Wn=t(84),Xn=t(85),Yn=t(1),Zn=Object(h.createHttpLink)({uri:"https://chat-application-hyungmogu.herokuapp.com/"}),ne=Object(Wn.a)((function(n,e){var t=e.headers,a=localStorage.getItem("AUTH_TOKEN");return{headers:Object(i.a)(Object(i.a)({},t),{},{authorization:a?"Bearer ".concat(a):""})}})),ee=new Xn.a({uri:"wss://chat-application-hyungmogu.herokuapp.com/graphql",options:{reconnect:!0,connectionParams:{authToken:localStorage.getItem("AUTH_TOKEN")}}}),te=Object(h.split)((function(n){var e=n.query,t=Object(Yn.q)(e),a=t.kind,r=t.operation;return"OperationDefinition"===a&&"subscription"===r}),ee,ne.concat(Zn)),ae=new h.ApolloClient({link:te,cache:new h.InMemoryCache});u.a.render(Object(v.jsx)(l.a.StrictMode,{children:Object(v.jsx)(h.ApolloProvider,{client:ae,children:Object(v.jsx)(Vn,{})})}),document.getElementById("root")),Gn()},94:function(n,e,t){},95:function(n,e,t){}},[[117,1,2]]]);
//# sourceMappingURL=main.4c43720a.chunk.js.map